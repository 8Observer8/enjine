(function(){window.module=function(a,b){this[a]==null&&(this[a]={});if(this[a].module==null)this[a].module=window.module;if(b!=null)return b.apply(this[a],[])}}).call(this);
(function(){this.module("Enjine",function(){return this.Drawable=function(){function a(){}a.prototype.zOrder=0;a.prototype.draw=function(){};return a}()})}).call(this);
(function(){this.module("Enjine",function(){return this.Camera=function(){function a(){}a.prototype.x=0;a.prototype.y=0;return a}()})}).call(this);
(function(){this.module("Enjine",function(){return this.DrawableManager=function(){function a(){}a.prototype.unsorted=!0;a.prototype.objects=[];a.prototype.add=function(c){object instanceof Array?this.objects=this.objects.concat(c):this.objects.push(c);this.unsorted=!0;return this};a.prototype.clear=function(){this.objects=[];return this};a.prototype.contains=function(){var c;for(c=this.objects.length;c-=1;);return!1};a.prototype.remove=function(c,a){var b,d,f,e;if(c instanceof Drawable)(b=this.objects.indexOf(c))>
-1&&[].splice.apply(this.objects,[b,b-b+1].concat([]));else if(c instanceof Array){e=this.objects;for(d=0,f=e.length;d<f;d++)b=e[d],this.remove(b)}else[].splice.apply(this.objects,[c,a-c].concat([]));return this};a.prototype.update=function(c){var a,b,d,f,e;f=this.objects;e=[];for(b=0,d=f.length;b<d;b++)a=f[b],e.push(typeof a.update==="function"?a.update(c):void 0);return e};a.prototype.draw=function(a,h){var b,d,f,e,g;if(this.unsorted)this.unsorted=!1,this.objects.sort(function(a,b){return a.zOrder-
b.zOrder});e=this.objects;g=[];for(d=0,f=e.length;d<f;d++)b=e[d],g.push(typeof b.draw==="function"?b.draw(a,h):void 0);return g};return a}()})}).call(this);
(function(){this.module("Enjine",function(){return this.Vector2=function(){function b(a,b){this.x=a;this.y=b}b.prototype.equals=function(a,b){return a instanceof Enjine.Vector2?this.x===a.x&&this.y===a.y:this.x===a&&this.y===b};b.prototype.dot=function(a){return this.x*a.x+this.y*a.y};b.prototype.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};b.prototype.normalize=function(){Math.sqrt(this.x*this.x+this.y*this.y);return this};b.prototype.add=function(a){this.x+=a.x;this.y+=a.y;return this};
b.prototype.sub=function(a){this.x-=a.x;this.y-=a.y;return this};b.prototype.scale=function(a){this.x*=a;this.y*=a;return this};b.prototype.mul=function(a){this.x*=a.x;this.y*=a.y;return this};b.prototype.div=function(a){this.x/=a.x;this.y/=a.y;return this};b.zero=new b(0,0);b.one=new b(1,1);b.unitX=new b(1,0);b.unitY=new b(0,1);b.dot=function(a,b){return a.x*b.x+a.y*b.y};b.len=function(a){return Math.sqrt(a.x*a.x+a.y*a.y)};b.add=function(a,c){return new b(a.x+c.x,a.y+c.y)};b.sub=function(a,c){return new b(a.x-
c.x,a.y-c.y)};b.scale=function(a,c){return new b(a.x*c,a.y*c)};b.mul=function(a,c){return new b(a.x*c.x,a.y*c.y)};b.div=function(a,c){return new b(a.x/c.x,a.y/c.y)};return b}()})}).call(this);
(function(){this.module("Enjine",function(){return this.GameStateContext=function(){function a(a){this.state=null;if(a!=null)this.state=a,this.state.enter()}a.prototype.changeState=function(a){this.state!=null&&this.state.exit();this.state=a;return this.state.enter()};a.prototype.update=function(a){if(this.state!=null)return this.state.checkForChange(this),this.state.update(a)};a.prototype.draw=function(a){var b;return(b=this.state)!=null?b.draw(a):void 0};return a}()});this.module("Enjine",function(){return this.GameState=
function(){function a(){}a.prototype.enter=function(){};a.prototype.exit=function(){};a.prototype.update=function(){};a.prototype.draw=function(){};a.prototype.checkForChange=function(){};return a}()})}).call(this);
(function(){var c=function(a,d){return function(){return a.apply(d,arguments)}};this.module("Enjine",function(){return this.GameCanvas=function(){function a(){}a.prototype.canvas=null;a.prototype.context2D=null;a.prototype.backBuffer=null;a.prototype.backBufferContext2D=null;a.prototype.betterBuffer=null;a.prototype.autoResolutionMode=!1;a.prototype.initialize=function(a,b,c){this.canvas=document.getElementById(a);this.context2D=this.canvas.getContext("2d");this.backBuffer=document.createElement("canvas");
this.backBuffer.width=b;this.backBuffer.height=c;this.betterBuffer=this.backBufferContext2D=this.backBuffer.getContext("2d");this.betterBuffer.width=this.backBuffer.width;this.betterBuffer.height=this.backBuffer.height;return this};a.prototype.beginDraw=function(){return this.backBufferContext2D.clearRect(0,0,this.backBuffer.width,this.backBuffer.height)};a.prototype.endDraw=function(){this.context2D.clearRect(0,0,this.canvas.width,this.canvas.height);return this.context2D.drawImage(this.backBuffer,
0,0,this.backBuffer.width,this.backBuffer.height,0,0,this.canvas.width,this.canvas.height)};a.prototype.fullScreen=function(a){this.autoResolutionMode=a;this.changeCanvasSize(window.innerWidth,window.innerHeight);window.onresize=c(function(){document.body.style.margin="0";document.body.style.padding="0";this.canvas.width=window.innerWidth;this.canvas.height=window.innerHeight;if(this.autoResolutionMode)return this.backBuffer.width=this.canvas.width,this.backBuffer.height=this.canvas.height,this.betterBuffer.width=
this.canvas.width,this.betterBuffer.height=this.canvas.height},this);return this};a.prototype.changeCanvasResolution=function(a,b){this.autoResolutionMode=!1;this.backBuffer.width=a;this.backBuffer.height=b;this.betterBuffer.width=a;this.betterBuffer.height=b;return this};a.prototype.changeCanvasSize=function(a,b){this.canvas.width=a;this.canvas.height=b;window.onresize=null;if(this.autoResolutionMode)this.backBuffer.width=a,this.backBuffer.height=b,this.betterBuffer.width=a,this.betterBuffer.height=
b;return this};return a}()})}).call(this);
(function(){var d=function(a,c){return function(){return a.apply(c,arguments)}};this.module("Enjine",function(){return this.GameTimer=function(){function a(){}a.prototype.framesPerSecond=1E3/30;a.prototype.lastTime=0;a.prototype.intervalFunc=null;a.prototype.updateObject=null;a.prototype.start=function(){this.lastTime=(new Date).getTime();this.intervalFunc=setInterval(d(function(){return this.tick()},this),this.framesPerSecond);return this};a.prototype.tick=function(){var a,b;b=(new Date).getTime();
a=(b-this.lastTime)/1E3;if(this.updateObject!=null)this.lastTime=b,this.updateObject.update(a);return this};a.prototype.stop=function(){clearInterval(this.intervalFunc);return this};return a}()})}).call(this);
(function(){var b=function(a,b){return function(){return a.apply(b,arguments)}};this.module("Enjine",function(){return this.Keys={a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:80,left:37,up:38,right:39,down:40}});this.module("Enjine",function(){return this.Keyboard={pressed:[],wasPressed:[],initialize:function(){document.onkeydown=b(function(a){return this.keyDownEvent(a)},this);return document.onkeyup=b(function(a){return this.keyUpEvent(a)},
this)},isKeyDown:function(a){return this.pressed[a]!=null?this.pressed[a]:!1},wasKeyDown:function(a){return this.wasPressed[a]!=null?this.wasPressed[a]&&!this.pressed[a]:!1},keyDownEvent:function(a){return this.pressed[a.keyCode]=!0},keyUpEvent:function(a){return this.pressed[a.keyCode]=!1},updatePressed:function(){return this.wasPressed=this.pressed.slice(0)}}})}).call(this);
(function(){var b=function(a,c){return function(){return a.apply(c,arguments)}};this.module("Enjine",function(){return this.Buttons={mouseLeft:0,mouseRight:2,mouseWheel:1}});this.module("Enjine",function(){return this.Mouse={x:0,y:0,pressed:[],wasPressed:[],element:null,containsMouse:!1,initialize:function(a){this.element=a;a.onmousedown=b(function(a){return this.pressed[a.button]=!0},this);a.onmouseup=b(function(a){return this.pressed[a.button]=!1},this);a.onmousemove=b(function(a){return this.mouseMoveEvent(a)},
this);a.onmouseover=b(function(){return this.containsMouse=!0},this);return a.onmouseout=b(function(){this.containsMouse=!1;return this.y=this.x=-1},this)},isButtonDown:function(a){return this.pressed[a]!=null?this.pressed[a]:!1},wasButtonDown:function(a){return this.wasPressed[a]!=null?this.wasPressed[a]&&!this.pressed[a]:!1},mouseMoveEvent:function(a){var b;this.x=a.pageX;this.y=a.pageY;a=this.element;if(a.offsetParent){for(b=[];a;)this.x-=a.offsetLeft,this.y-=a.offsetTop,b.push(a=a.offsetParent);
return b}},updatePressed:function(){return this.wasPressed=this.pressed.slice(0)}}})}).call(this);
(function(){this.module("Enjine",function(){return this.Resources={images:{},sounds:{},destroy:function(){delete this.images;delete this.sounds;return this},addImage:function(a,b){var c;c=new Image;this.images[a]=c;c.src=b;return this},addImages:function(a){var b,c,d,e;for(d=0,e=a.length;d<e;d++)b=a[d],c=new Image,this.images[b.name]=c,c.src=b.src;return this},clearImages:function(){delete this.images;this.images={};return this},removeImage:function(a){delete this.images[a];return this},addSound:function(a,
b,c){var d;this.sounds[a]=[];this.sounds[a].index=0;c||(c=3);for(d=0;d<c;)this.sounds[a][d]=new Audio(b),d++;return this},clearSounds:function(){delete this.sounds;this.sounds={};return this},removeSound:function(a){delete this.sounds[a];return this},pauseChannel:function(a,b){this.sounds[a][b].paused||this.sounds[a][b].pause();return this},pauseSound:function(a){var b,c,d;d=this.sounds[a];for(b=0,c=d.length;b<c;b++)a=d[b],a.paused||a.pause();return this},resetChannel:function(a,b){this.sounds[a][b].currentTime=
0;this.stopLoop(a,b);return this},resetSound:function(a){var b,c,d,e;e=this.sounds[a];for(c=0,d=e.length;c<d;c++)b=e[c],b.currentTime=0,this.stopLoop(a,c);return this},stopLoop:function(a,b){return this.sounds[a][b].removeEventListener("ended",this.loopCallback,!1)},loopCallback:function(){this.currentTime=-1;this.play();return this},playSound:function(a,b){if(this.sounds[a].index>=this.sounds[a].length)this.sounds[a].index=0;b&&this.sounds[a][this.sounds[a].index].addEventListener("ended",this.loopCallback,
!1);this.sounds[a][this.sounds[a].index++].play();return this.sounds[a].index}}})}).call(this);
(function(){var e=Object.prototype.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);c.prototype=b.prototype;a.prototype=new c;a.__super__=b.prototype;return a};this.module("Enjine",function(){return this.Sprite=function(){function a(){a.__super__.constructor.apply(this,arguments)}f(a,this.Drawable);a.prototype.xPivot=0.5;a.prototype.yPivot=0.5;a.prototype.angle=0;a.prototype.xScale=1;a.prototype.yScale=1;a.prototype.image=null;a.prototype.draw=
function(a,c){a.save();a.translate(this.x-c.x,this.y-c.y);a.rotate(this.angle);a.scale(this.xScale,this.yScale);a.drawImage(this.image,-this.image.width*this.xPivot,-this.image.height*this.yPivot);a.restore();return this};return a}.call(this)})}).call(this);
(function(){var e=Object.prototype.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);c.prototype=b.prototype;a.prototype=new c;a.__super__=b.prototype;return a};this.module("Enjine",function(){return this.FrameSprite=function(){function a(){a.__super__.constructor.apply(this,arguments)}f(a,this.Sprite);a.prototype.frameX=0;a.prototype.frameY=0;a.prototype.frameWidth=0;a.prototype.frameHeight=0;a.prototype.draw=function(a,c){a.save();a.translate(this.x-
c.x,this.y-c.y);a.rotate(angle);a.scale(this.xScale,this.yScale);a.drawImage(this.image,this.frameX,this.frameY,this.frameWidth,this.frameHeight,-this.frameWidth*this.xPivot,-this.frameHeight*this.yPivot,this.frameWidth,this.frameHeight);a.restore();return this};return a}.call(this)})}).call(this);
(function(){var m=Object.prototype.hasOwnProperty,n=function(a,c){function f(){this.constructor=a}for(var b in c)m.call(c,b)&&(a[b]=c[b]);f.prototype=c.prototype;a.prototype=new f;a.__super__=c.prototype;return a};this.module("Enjine",function(){return this.SpriteFont=function(){function a(c,a,b,d){this.image=c;this.letterWidth=a;this.letterHeight=b;this.letters=d;this.lineHeight=this.letterSpacing=0;this.strings=[]}n(a,this.Drawable);a.prototype.addString=function(c,a,b){this.strings.push({string:c,
x:a,y:b});return this};a.prototype.removeString=function(a){[].splice.apply(this.strings,[a,a-a+1].concat([]));return this};a.prototype.draw=function(a,f){var b,d,e,g,i,h,k,l,j;j=this.strings;for(h=0,k=j.length;h<k;h++){e=j[h];g=e.x;i=e.y;b=e.string;for(d=0,l=b.length;d<l;d++)b=e.string.charCodeAt(d),b===10?(i+=this.letterHeight+this.lineHeight,g=e.x):(a.drawImage(this.image,this.letters[b].x,this.letters[b].y,this.letterWidth,this.letterHeight,g-f.x,i-f.y,this.letterWidth,this.letterHeight),g+=this.letterWidth+
this.letterSpacing)}return this};return a}.call(this)})}).call(this);
(function(){var e=Object.prototype.hasOwnProperty,f=function(a,c){function b(){this.constructor=a}for(var d in c)e.call(c,d)&&(a[d]=c[d]);b.prototype=c.prototype;a.prototype=new b;a.__super__=c.prototype;return a};this.module("Enjine",function(){return this.AnimationSequence=function(){return function(a,c,b,d){this.startRow=a;this.startColumn=c;this.endRow=b;this.endColumn=d;this.singleFrame=!1;if(this.startRow===this.endRow&&this.startColumn===this.endColumn)this.singleFrame=!0}}()});this.module("Enjine",
function(){return this.AnimatedSprite=function(){function a(){a.__super__.constructor.apply(this,arguments)}f(a,this.FrameSprite);a.prototype.lastElapsed=0;a.prototype.framesPerSecond=0.05;a.prototype.currentSequence=null;a.prototype.playing=!1;a.prototype.looping=!1;a.prototype.sequences={};a.prototype.update=function(a){var b;if(!this.currentSequence.singleFrame&&this.playing&&(this.lastElapsed-=a,!(this.lastElapsed>0))){this.lastElapsed=this.framesPerSecond;this.frameX+=this.frameWidth;if(this.frameX>
this.image.width-this.frameWidth&&(this.frameX=0,this.frameY+=this.frameHeight,this.frameY>this.image.height-this.frameHeight))this.frameY=0;this.frameX>this.currentSequence.endColumn*this.frameWidth&&this.frameY===this.currentSequence.endRow*this.frameHeight?b=!0:this.frameX===0&&this.frameY>this.currentSequence.endRow*this.frameHeight&&(b=!0);if(b)return this.looping?(this.frameX=this.currentSequence.startColumn*this.frameWidth,this.frameY=this.currentSequence.startRow*this.frameHeight):this.playing=
!1}};a.prototype.playSequence=function(a,b){this.playing=!0;this.looping=b;this.currentSequence=this.sequences["seq_"+a];this.frameX=this.currentSequence.startColumn*this.frameWidth;this.frameY=this.currentSequence.startRow*this.frameHeight;return this};a.prototype.stopLooping=function(){this.looping=!1;return this};a.prototype.stopPlaying=function(){this.playing=!1;return this};a.prototype.setFrameWidth=function(a){this.frameWidth=a;return this};a.prototype.setFrameHeight=function(a){this.frameHeight=
a;return this};a.prototype.setColumnCount=function(a){this.frameWidth=this.image.width/a;return this};a.prototype.setRowCount=function(a){this.frameHeight=this.image.height/a;return this};a.prototype.addSequence=function(a,b){this.sequences["seq_"+a]=b;return this};a.prototype.addNewSequence=function(a,b,d,e,f){this.sequences["seq_"+a]=new Enjine.AnimationSequence(b,d,e,f);return this};a.prototype.deleteSequence=function(a){delete this.sequences["seq_"+a];return this};a.prototype.clearSequences=function(){delete this.sequences;
this.sequences={};return this};return a}.call(this)})}).call(this);
(function(){var b=function(a,c){return function(){return a.apply(c,arguments)}};this.module("Enjine",function(){return this.Application=function(){function a(){this.initialize=b(this.initialize,this);this.update=b(this.update,this)}a.prototype.canvas=null;a.prototype.timer=null;a.prototype.stateContext=null;a.prototype.update=function(a){this.stateContext.update(a);this.canvas.beginDraw();this.stateContext.draw(this.canvas.betterBuffer);this.canvas.endDraw();Enjine.Keyboard.updatePressed();return Enjine.Mouse.updatePressed()};
a.prototype.initialize=function(a,b,d,e){this.canvas=new Enjine.GameCanvas;this.timer=new Enjine.GameTimer;Enjine.Keyboard.initialize();Enjine.Mouse.initialize(document.getElementById(a));this.canvas.initialize(a,d,e);this.timer.updateObject=this;this.stateContext=new Enjine.GameStateContext(b);return this.timer.start()};return a}()})}).call(this);
